---
layout: page
---
{% assign subclubs = site.subclubs | group_by: "category" %}
{% assign subclub = page.category %}
{% assign subclub_schedule = page.schedule %}
{% assign subclub_obj = subclubs | where: "name", subclub | first %}

{% if site.production == true %}
  {% assign lessons = site.lessons | group_by: "category" %}
  {% assign subclub_obj = lessons | where: "name", subclub | first %}
{% endif %}

<div class="breadcrumbs">
  <a href="{{ site.baseurl }}/" class="icon-home"></a> / <a href="{{ site.baseurl }}/subclubs/">Subclubs</a> / <strong class="breadcrumbs-current">{{ page.title | xml_escape }}</strong>
</div>
<div class="row">
  <div class="three columns" id="lesson-listing">
    <h3>Lessons</h3>
    <div id="lesson-timeline">
      <h5 class="lesson-state">Last lesson</h5>
      <p class="lesson-name lesson-last"></p>
      <h5 class="lesson-state">Next meeting</h5>
      <p class="lesson-name lesson-next"></p>
    </div>
    {% assign ordered_lessons = subclub_obj.items | sort: "lesson" %}
    {% for item in ordered_lessons %}
      {% assign lesson_obj = item %}
      {% for entry in subclub_schedule %}
        {% assign split_path = item.path | split: '/' %}
        {% if split_path contains entry[0] %}
    <div class="lesson">
      <a href="{{ lesson_obj.url | split: '/' | pop | join: '/' | uri_escape }}/" title="{{ entry[1] | xml_escape }}">{{ lesson_obj.title | xml_escape }}</a>
    </div>
          {% break %}
        {% endif %}
      {% endfor %}
    {% endfor %}
  </div>
  <div class="nine columns">
    {{ content }}
  </div>
</div>

<script>window.addEventListener("DOMContentLoaded", function (){
  APP.renderSubclubSchedule($('#lesson-timeline'),{
    {% for entry in subclub_schedule %}
      {% assign lesson_title = subclub_title | xml_escape %}
      {% assign lesson_url = '' %}
      {% for item in subclub_obj.items %}
        {% assign split_path = item.path | split: '/' %}
        {% if split_path contains entry[0] %}
          {% assign lesson_title = item.title | xml_escape %}
          {% assign lesson_url = item.url | split: '/' | pop | join: '/' | uri_escape %}
          {% break %}
        {% endif %}
      {% endfor %}
    "{{ entry[0] | xml_escape }}": {
      date: "{{ entry[1] | xml_escape }}",
      url: "{{ lesson_url }}/",
      title: "{{ lesson_title }}"
    },
    {% endfor %}
  })});
</script>
