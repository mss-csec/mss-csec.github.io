---
layout: default
---

<div class="hero">
  <canvas id="background-anim"></canvas>
  <h1 class="title">
    <em>Computer</em><br>
    <em>Science</em><br>
    <em>Education</em><br>
    <em>Club</em>
  </h1>
  <a id="background-anim-desc" target="_blank"></a>
</div>

<!-- Display schedule -->

<div class="schedule">
  <div class="container">
    {% comment %}
    Change the below variable to change the number of lessons displayed in one row
    {% endcomment %}
    {% assign row_size = 3 %}

    {% assign row_matrix = "null,twelve,six,four,three,null,two" | split: "," %}
    {% assign subclubs = site.subclubs | group_by: "category" | where_exp: "item", "item.name != 'subclub-landing'" %}
    {% assign number_rows = site.displayed_subclubs.size | divided_by: row_size %}
    {% for row in (0..number_rows) %}
    <div class="row">
      {% assign row_offset = row | times: row_size %}
      {% for subclub in site.displayed_subclubs limit:row_size offset:row_offset %}
        {% assign subclub_obj = subclubs | where: "name", subclub | first %}
        {% assign subclub_index = subclub_obj.items | where: "layout", "landing" | first %}
        {% assign subclub_schedule = subclub_index.schedule %}
        {% assign subclub_title = subclub_index.title %}
        {% assign subclub_url = subclub_index.url | split: '/' | pop | join: '/' | uri_escape %}
      <div class="{{ row_matrix[row_size] }} columns" id="schedule-{{ subclub | xml_escape }}">
        <h2 class="subclub-title"><a href="{{ subclub_url }}/" class="subclub-link">{{ subclub_title | xml_escape }}</a></h2>
        <div class="row">
          <div class="one-half column">
            <h4 class="lesson-state">Last lesson</h4>
            <h3 class="lesson-name lesson-last"></h3>
          </div>
          <div class="one-half column">
            <h4 class="lesson-state">Next meeting</h4>
            <h3 class="lesson-name lesson-next"></h3>
          </div>
        </div>
        <script>SCRIPTS.add(function (){
        APP.renderSubclubSchedule($('[id="schedule-{{ subclub | xml_escape }}"]'),{
          {% if site.production == true %}
            {% assign lessons = site.lessons | group_by: "category" %}
            {% assign subclub_obj = lessons | where: "name", subclub | first %}
          {% endif %}
          {% for entry in subclub_schedule %}
            {% assign lesson_title = subclub_title | xml_escape %}
            {% assign lesson_url = subclub_url | uri_escape %}
            {% for item in subclub_obj.items %}
              {% assign split_path = item.path | split: '/' %}
              {% if split_path contains entry[0] %}
                {% assign lesson_title = item.title | xml_escape %}
                {% assign lesson_url = item.url | split: '/' | pop | join: '/' | uri_escape %}
                {% break %}
              {% endif %}
            {% endfor %}
          "{{ entry[0] | xml_escape }}": {
            date: "{{ entry[1] | date: site.datefmt }}",
            url: "{{ lesson_url }}/",
            title: "{{ lesson_title }}"
          },
          {% endfor %}
        });
        });</script>
      </div>
      {% endfor %}
      <!-- {% comment %}{ if row >= number_rows and subclubs.size > site.displayed_subclubs.size %}{% endcomment %} -->
      <div class="{{ row_matrix[row_size] }} columns more-subclubs">
      {% comment %}<!--
        <h2 class="subclub-title"><a href="{{ '/subclubs/' | relative_url }}" class="subclub-link">More subclubs</a></h2>
        <div class="more-subclubs-listing">
          {% assign subclub_counter = 0 %}
          {% for subclub_obj in subclubs %}
            {% if site.displayed_subclubs contains subclub_obj.name %}
              {% continue %}
            {% endif %}
            {% if subclub_counter >= 4 %}
              {% break %}
            {% endif %}
            {% assign subclub_index = subclub_obj.items | where: "layout", "landing" | first %}
            {% assign subclub_title = subclub_index.title | xml_escape %}
            {% assign subclub_url = subclub_index.url | split: '/' | pop | join: '/' | uri_escape %}
            <h4><a class="lesson-link" href="{{ subclub_url }}/">{{ subclub_title }}</a></h4>
            {% assign subclub_counter = subclub_counter | plus: 1 %}
          {% endfor %}
        </div>
      -->{% endcomment %}
        <h2 class="subclub-title"><a href="{{ site.signup_link }}" class="subclub-link">Sign up for CSEC</a></h2>
        <div class="more-subclubs-listing" style="display:block">
          <a class="lesson-link" href="{{ site.signup_link }}"><h4>Be the first to receive updates about our lessons and activities.</h4></a>
          <p class="disabled" style="margin-bottom:0">Requires a valid YRDSB Gapps account.</p>
        </div>
      </div>
      <!-- {% comment %}{ endif %}{% endcomment %} -->
    </div>
    {% endfor %}
  </div>
</div>

<div class="container row">
  <div class="one-half column announcements">
    <h2><a href="{{ '/posts/' | relative_url }}"><em class="offset-text">Announcements</em></a></h2>
    {% for post in site.posts limit: 3 %}
    <article>
      <header>
        <h3><a href="{{ post.url }}">{{ post.title }}</a></h3>
        <h6>Posted on <time datetime="{{ post.date | date: site.mdatefmt }}">{{ post.date | date: site.datefmt }}</time></h6>
      </header>
      <p>{{ post.excerpt | strip_html | truncatewords: 50 }}</p>
    </article>
    {% endfor %}
    <a href="{{ '/posts/' | relative_url }}" class="view-all">View all posts<span class="dots"><span class="dot"></span><span class="dot"></span><span class="dot"></span></span></a>
  </div>
  <div class="one-half column resources">
    <h2><a href="{{ '/resources/' | relative_url }}"><em class="offset-text">Resources</em></a></h2>

    {% for resource_id in site.displayed_resources %}
      {% for resource in site.resources %}
        {% if resource.path contains resource_id %}
    <article>
      <header>
        <h3><a href="{{ resource.url }}">{{ resource.title }}</a></h3>
      </header>
      {{ resource.summary | markdownify }}
    </article>
          {% break %}
        {% endif %}
      {% endfor %}
    {% endfor %}
    <a href="{{ '/resources/' | relative_url }}" class="view-all">View all resources<span class="dots"><span class="dot"></span><span class="dot"></span><span class="dot"></span></span></a>
  </div>
</div>

<script>
SCRIPTS.add(function() {
  var game,
      cellDimensions = 10,
      initCells = function() {
    // get hero's dimensions and create a matrix based on that
    var heroWidth = $('.hero').width(),
        heroHeight = $('.hero').height() + 20,
        cellsX = Math.ceil(heroWidth / cellDimensions),
        cellsY = Math.ceil(heroHeight / cellDimensions),
        array = [];

    $('#background-anim')
      .attr('width', cellsX * cellDimensions)
      .attr('height', cellsY * cellDimensions)
      .css({
        left: (heroWidth - cellsX * cellDimensions) / 2,
        top: (heroHeight - cellsY * cellDimensions) / 2
      });

    for (var i=0; i<cellsY; i++) {
      array.push(new Array(cellsX));
      for (var j=0; j<cellsX; j++) {
        array[i][j] = Math.random() < 0.2;
      }
    }

    return array.slice();
  }, initGame = function() {
    game = new GameOfLife({
      init_cells: initCells(),
      cell_width: cellDimensions,
      cell_height: cellDimensions,
      canvas_id: 'background-anim',
      colourful: true
    }),
    delay = performance.now(),
    step = function(timestamp) {
      if (timestamp - delay >= 200) {
        delay = timestamp;
        game.step();
      }

      return reqAnimFrame = requestAnimationFrame(step);
    };

    reqAnimFrame = requestAnimationFrame(step);
  }, reqAnimFrame, resizeTimeout;

  $.when(
    $.getScript("{{ '/assets/lib/gameoflife.js' | relative_url }}")
  ).then(initGame, function(err) {
    console.error(err);
  });

  $(window).on('resize', function() {
    cancelAnimationFrame(reqAnimFrame);
    clearTimeout(resizeTimeout);

    resizeTimeout = setTimeout(initGame, 1000);
  });

  $(window).on('changetheme', function(e) {
    game.changeTheme();
  });

  $('#background-anim-desc')
    .attr('href', 'https://github.com/nomatteus/conway-game-of-life-js')
    .text('Conway\'s Game of Life | Matt Ruten');

  $('body').addClass('has-anim');
});
</script>
