(function(){var t;t=function(){function t(t,e,i){this.canvas=t.getContext("2d"),this.genc=e,this.grid={x:e.length,y:e[0].length},null!=i.grid&&(this.grid=i.grid),null!=i.cell&&(this.cell=i.cell),this.canvas.fillStyle="light"===APP.currentTheme?"#eeebeb":"#2d2d35"}return t.prototype.canvas=null,t.prototype.gen=0,t.prototype.genc=[],t.prototype.history=5,t.prototype.seedweight=.2,t.prototype.grid={x:50,y:50},t.prototype.cell={w:10,h:10},t.prototype._countNeighbours=function(t,e){var i,n,r,h;return n=t+1>this.grid.x-1?0:t+1,i=t-1<0?this.grid.x-1:t-1,h=e+1>this.grid.y-1?0:e+1,r=e-1<0?this.grid.y-1:e-1,this.genc[i][r]+this.genc[t][r]+this.genc[n][r]+this.genc[i][e]+this.genc[n][e]+this.genc[i][h]+this.genc[t][h]+this.genc[n][h]},t.prototype._getState=function(t,e){var i,n;return i=this.genc[t][e],!!(3===(n=this._countNeighbours(t,e))||2===n&&i)},t.prototype.runGeneration=function(){var t,e;return this.genc=function(){var i,n,r;for(r=[],t=i=0,n=this.grid.x;0<=n?i<n:i>n;t=0<=n?++i:--i)r.push(function(){var i,n,r;for(r=[],e=i=0,n=this.grid.y;0<=n?i<n:i>n;e=0<=n?++i:--i)r.push(this._getState(t,e));return r}.call(this));return r}.call(this),this.gen++},t.prototype.render=function(){var t,e,i,n,r,h;for(r=t=0,i=this.grid.x;0<=i?t<i:t>i;r=0<=i?++t:--t)for(h=e=0,n=this.grid.y;0<=n?e<n:e>n;h=0<=n?++e:--e)this.genc[r][h]?this.canvas.fillRect(r*this.cell.w,h*this.cell.h,this.cell.w,this.cell.h):this.canvas.clearRect(r*this.cell.w,h*this.cell.h,this.cell.w,this.cell.h);return!0},t.prototype.changeTheme=function(){return this.canvas.fillStyle="light"===APP.currentTheme?"#eeebeb":"#2d2d35"},t.prototype.step=function(){return this.runGeneration(),this.render()},t}(),window.GameOfLife=t}).call(this);